version: 1.0
runtime: python311

build:
  commands:
    pre-build:
      - echo "Starting pre-build phase..."
      - python --version
      - pip --version
      - pip install --upgrade pip setuptools wheel
    build:
      - echo "Installing Python dependencies..."
      - pip install --no-cache-dir -r requirements.txt
    post-build:
      - echo "Downloading spaCy model..."
      - python -m spacy download en_core_web_sm
      - echo "Build completed successfully"

run:
  runtime-version: "3.11"
  command: streamlit run streamlit/app_streamlit.py --server.port=8501 --server.address=0.0.0.0
  network:
    port: 8501
    env: APP_PORT
  env:
    - name: STREAMLIT_SERVER_PORT
      value: "8501"
    - name: STREAMLIT_SERVER_ADDRESS
      value: "0.0.0.0"
